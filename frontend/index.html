<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUMBLE - Media Streaming</title>
    <link rel="stylesheet" href="styles.css?v=21">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-text">CRUMBLE</span>
                </div>
            </div>
            
            <div class="nav-items">
                <button class="nav-item active" data-tab="home">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9,22 9,12 15,12 15,22"/>
                    </svg>
                    <span class="nav-label">Home</span>
                </button>
                
                <button class="nav-item" data-tab="search">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.35-4.35"/>
                    </svg>
                    <span class="nav-label">Search</span>
                </button>
                
                <button class="nav-item" data-tab="library">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
                    </svg>
                    <span class="nav-label">Library</span>
                </button>
                
                <button class="nav-item" data-tab="settings">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    <span class="nav-label">Settings</span>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Home Tab -->
            <div id="home-tab" class="tab-content active">
                <div class="hero-banner" id="hero-banner">
                    <!-- Hero content will be dynamically loaded -->
                </div>
                
                <div class="content-sections">
                    <section class="carousel-section" id="trending-movies">
                        <h2 class="carousel-title">Trending Movies</h2>
                        <div id="trending-movies-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                    
                    <section class="carousel-section" id="popular-movies">
                        <h2 class="carousel-title">Popular Movies</h2>
                        <div id="popular-movies-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                    
                    <section class="carousel-section" id="trending-series">
                        <h2 class="carousel-title">Trending Series</h2>
                        <div id="trending-series-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                    
                    <section class="carousel-section" id="popular-series">
                        <h2 class="carousel-title">Popular Series</h2>
                        <div id="popular-series-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search-tab" class="tab-content">
                <div class="search-container">
                    <div class="search-header">
                        <h1>Search</h1>
                        <div class="search-input-container">
                            <input type="text" id="search-input" placeholder="Search movies, series, and more..." autocomplete="off" aria-label="Search content" aria-describedby="search-hint">
                            <button id="search-button" aria-label="Search">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="11" cy="11" r="8"/>
                                    <path d="m21 21-4.35-4.35"/>
                                </svg>
                            </button>
                        </div>
                        <div class="search-hint" id="search-hint">
                            Press <kbd>Ctrl</kbd>+<kbd>K</kbd> (or <kbd>Cmd</kbd>+<kbd>K</kbd>) to focus search
                        </div>
                    </div>
                    
                    <div class="search-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="movies">Movies</button>
                        <button class="filter-btn" data-filter="series">Series</button>
                        <button class="filter-btn" data-filter="people">People</button>
                    </div>
                    
                    <div class="search-results" id="search-results">
                        <div class="search-placeholder">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            <p>Start typing to search for content</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Library Tab -->
            <div id="library-tab" class="tab-content">
                <div class="library-container">
                    <div class="library-header">
                        <h1>My Library</h1>
                        <div class="library-stats">
                            <span class="stat">
                                <span class="stat-number" id="watchlist-count">0</span>
                                <span class="stat-label">Watchlist</span>
                            </span>
                            <span class="stat">
                                <span class="stat-number" id="watching-count">0</span>
                                <span class="stat-label">Watching</span>
                            </span>
                            <span class="stat">
                                <span class="stat-number" id="completed-count">0</span>
                                <span class="stat-label">Completed</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="library-sections">
                        <section class="library-section">
                            <h2>Continue Watching</h2>
                            <div class="library-grid" id="continue-watching">
                                <!-- Content will be dynamically loaded -->
                            </div>
                        </section>
                        
                        <section class="library-section">
                            <h2>Watchlist</h2>
                            <div class="library-grid" id="watchlist">
                                <!-- Content will be dynamically loaded -->
                            </div>
                        </section>
                        
                        <section class="library-section">
                            <h2>Recently Added</h2>
                            <div class="library-grid" id="recently-added">
                                <!-- Content will be dynamically loaded -->
                            </div>
                        </section>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="settings-container">
                    <div class="settings-header">
                        <h1>Settings</h1>
                    </div>
                    
                    <div class="settings-sections">
                        <section class="settings-section">
                            <h2>API Configuration</h2>
                            <div class="setting-item">
                                <label for="tmdb-api-key">TMDB API Key</label>
                                <div class="tmdb-api-controls">
                                    <input type="password" id="tmdb-api-key" placeholder="Enter your TMDB API key (optional)">
                                    <button id="save-tmdb-key" class="btn-secondary save-btn">Save</button>
                                </div>
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="toggle-default-tmdb" checked>
                                        <span class="toggle-slider"></span>
                                        Use Default TMDB API
                                    </label>
                                </div>
                                <p class="setting-description">Use your own TMDB API key for higher rate limits. Toggle off default API to use only your key.</p>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>Catalog Sources</h2>
                            <div class="catalog-toggles">
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="toggle-movies" checked>
                                        <span class="toggle-slider"></span>
                                        Movies
                                    </label>
                                </div>
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="toggle-series" checked>
                                        <span class="toggle-slider"></span>
                                        TV Series
                                    </label>
                                </div>
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="toggle-trending" checked>
                                        <span class="toggle-slider"></span>
                                        Trending Content
                                    </label>
                                </div>
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="toggle-popular" checked>
                                        <span class="toggle-slider"></span>
                                        Popular Content
                                    </label>
                                </div>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>Catalog Management</h2>
                            <p class="section-description">Manage all your catalogs from different sources including MDBList, TMDB, and Stremio add-ons.</p>
                            <div class="catalog-management">
                                <div class="catalog-stats" id="catalog-stats">
                                    <div class="stat-item">
                                        <span class="stat-number" id="total-catalogs">0</span>
                                        <span class="stat-label">Total Catalogs</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="enabled-catalogs">0</span>
                                        <span class="stat-label">Enabled</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="total-items">0</span>
                                        <span class="stat-label">Total Items</span>
                                    </div>
                                </div>
                                
                                <div class="catalog-controls">
                                    <button id="refresh-all-catalogs" class="btn-primary">
                                        🔄 Refresh All Catalogs
                                    </button>
                                    <button id="export-catalogs" class="btn-secondary">
                                        📤 Export Catalogs
                                    </button>
                                    <label for="import-catalogs" class="btn-secondary file-input-label">
                                        📥 Import Catalogs
                                        <input type="file" id="import-catalogs" accept=".json" style="display: none;">
                                    </label>
                                </div>
                                
                                <div class="catalog-filters">
                                    <div class="filter-group">
                                        <label>Filter by Source:</label>
                                        <select id="catalog-source-filter">
                                            <option value="all">All Sources</option>
                                            <option value="mdblist">MDBList</option>
                                            <option value="tmdb">TMDB</option>
                                            <option value="stremio">Stremio Add-ons</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label>Filter by Type:</label>
                                        <select id="catalog-type-filter">
                                            <option value="all">All Types</option>
                                            <option value="movie">Movies</option>
                                            <option value="tv">TV Shows</option>
                                            <option value="mixed">Mixed</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="catalog-list" id="catalog-list">
                                    <!-- Catalogs will be dynamically loaded -->
                                </div>
                                
                                <div class="catalog-settings">
                                    <h3>Auto-Refresh Settings</h3>
                                    <div class="toggle-item">
                                        <label class="toggle-label">
                                            <input type="checkbox" id="auto-refresh-catalogs" checked>
                                            <span class="toggle-slider"></span>
                                            Enable Auto-Refresh
                                        </label>
                                    </div>
                                    <div class="setting-group">
                                        <label for="refresh-interval">Refresh Interval (minutes):</label>
                                        <input type="number" id="refresh-interval" min="5" max="1440" value="30" class="settings-input">
                                    </div>
                                </div>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>Add-ons</h2>
                            <p class="section-description">Manage your Stremio add-ons to access different streaming sources and content libraries.</p>
                            <div class="addon-management">
                                <div class="addon-input-container">
                                    <div class="addon-input-group">
                                        <div class="input-wrapper">
                                            <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                                            </svg>
                                            <input type="url" id="addon-url" placeholder="https://example.com/manifest.json" class="addon-url-input">
                                        </div>
                                        <button id="add-addon-btn" class="addon-add-btn">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <line x1="12" y1="5" x2="12" y2="19"/>
                                                <line x1="5" y1="12" x2="19" y2="12"/>
                                            </svg>
                                            Add Add-on
                                        </button>
                                    </div>
                                    <div class="addon-help">
                                        <div class="help-item">
                                            <span class="help-icon">💡</span>
                                            <span>Add-ons provide access to different streaming sources and content libraries</span>
                                        </div>
                                        <div class="help-item">
                                            <span class="help-icon">🔗</span>
                                            <span>Enter the full manifest URL (usually ends with /manifest.json)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="addon-list" id="addon-list">
                                    <!-- Add-ons will be dynamically loaded -->
                                </div>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>External Players</h2>
                            <div class="player-settings">
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="enable-infuse" checked>
                                        <span class="toggle-slider"></span>
                                        INFUSE
                                    </label>
                                </div>
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="enable-vlc" checked>
                                        <span class="toggle-slider"></span>
                                        VLC
                                    </label>
                                </div>
                                <div class="toggle-item">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="enable-outplayer" checked>
                                        <span class="toggle-slider"></span>
                                        OUTPLAYER
                                    </label>
                                </div>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>Diagnostics & Troubleshooting</h2>
                            <div class="diagnostic-controls">
                                <button onclick="app.addonDiagnostics.performHealthCheck()" class="btn-primary">
                                    🔍 Run Addon Health Check
                                </button>
                                <button onclick="app.addonDiagnostics.installCommonAddons()" class="btn-secondary">
                                    📦 Install Popular Addons
                                </button>
                                <button onclick="app.streamScraper.enableDebug()" class="btn-secondary">
                                    🐛 Enable Debug Mode
                                </button>
                                <button onclick="console.log(app.streamScraper.getStats())" class="btn-secondary">
                                    📊 Show Stats
                                </button>
                            </div>
                            <p class="setting-description">Diagnose addon connectivity issues and get recommendations for fixing streaming problems.</p>
                        </section>
                        
                        <section class="settings-section">
                            <h2>Cache & Storage</h2>
                            <div class="cache-controls">
                                <button id="clear-cache-btn" class="danger-btn">Clear Cache</button>
                                <button id="reset-settings-btn" class="danger-btn">Reset All Settings</button>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="stream-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="stream-modal-title">Select Stream</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stream-list" id="stream-list">
                    <!-- Stream options will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <div id="media-modal" class="modal">
        <div class="modal-content media-modal-content">
            <div class="modal-header">
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="media-details" id="media-details">
                    <!-- Media details will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Scripts -->
    <script src="StreamScraperV3.js"></script>
    <script src="AddonDiagnostics.js"></script>
    <script src="HomeTab.js"></script>
    <script src="SearchTab.js"></script>
    <script src="LibraryTab.js"></script>
    <script src="SettingsTab.js"></script>
    <script src="js/mdblist-browser.js"></script>
    <script src="MDBListIntegration.js"></script>
    <script src="TMDBIntegration.js"></script>
    <script src="CatalogManager.js"></script>
    <script src="CatalogGrid.js"></script>
    <script src="CatalogCarousel.js?v=2"></script>
    <script src="MediaDetailsModal.js"></script>
    <script src="HeroBanner.js"></script>
    <script src="StreamListModal.js"></script>
    <script src="ExternalPlayerHandler.js"></script>
    <script src="app.js"></script>
</body>
</html>