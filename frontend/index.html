<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUMBLE - Media Streaming</title>
    <link rel="stylesheet" href="styles.css?v=21">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-text">CRUMBLE</span>
                </div>
            </div>
            
            <div class="nav-items">
                <button class="nav-item active" data-tab="home">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9,22 9,12 15,12 15,22"/>
                    </svg>
                    <span class="nav-label">Home</span>
                </button>
                
                <button class="nav-item" data-tab="search">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.35-4.35"/>
                    </svg>
                    <span class="nav-label">Search</span>
                </button>
                
                <button class="nav-item" data-tab="library">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
                    </svg>
                    <span class="nav-label">Library</span>
                </button>
                
                <button class="nav-item" data-tab="settings">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    <span class="nav-label">Settings</span>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Home Tab -->
            <div id="home-tab" class="tab-content active">
                <div class="hero-banner" id="hero-banner">
                    <!-- Hero content will be dynamically loaded -->
                </div>
                
                <div class="content-sections">
                    <section class="carousel-section" id="trending-movies">
                        <h2 class="carousel-title">Trending Movies</h2>
                        <div id="trending-movies-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                    
                    <section class="carousel-section" id="popular-movies">
                        <h2 class="carousel-title">Popular Movies</h2>
                        <div id="popular-movies-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                    
                    <section class="carousel-section" id="trending-series">
                        <h2 class="carousel-title">Trending Series</h2>
                        <div id="trending-series-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                    
                    <section class="carousel-section" id="popular-series">
                        <h2 class="carousel-title">Popular Series</h2>
                        <div id="popular-series-grid">
                            <!-- Content will be dynamically loaded -->
                        </div>
                    </section>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search-tab" class="tab-content">
                <div class="search-container">
                    <div class="search-header">
                        <h1>Search</h1>
                        <div class="search-form-container">
                            <form class="search-form flex bg-zinc-800 border border-zinc-700 text-white rounded-md shadow text-sm" id="search-form">
                                <div aria-disabled="true" class="w-10 grid place-content-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="limegreen" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.3-4.3"></path>
                                    </svg>
                                </div>
                                <input type="text" spellcheck="false" name="text" id="search-input" class="bg-transparent py-1.5 outline-none placeholder:text-zinc-400 w-20 focus:w-48 transition-all" placeholder="Search..." autocomplete="off" aria-label="Search content" aria-describedby="search-hint">
                                <button class="w-10 grid place-content-center" aria-label="Clear input button" type="reset" id="search-clear">
                                    <svg stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="limegreen" fill="none" viewBox="0 0 24 24" height="16" width="16" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 6 6 18"></path>
                                        <path d="m6 6 12 12"></path>
                                    </svg>
                                </button>
                            </form>
                        </div>
                        <div class="search-hint" id="search-hint">
                            Press <kbd>Ctrl</kbd>+<kbd>K</kbd> (or <kbd>Cmd</kbd>+<kbd>K</kbd>) to focus search
                        </div>
                    </div>
                    
                    <div class="search-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="movies">Movies</button>
                        <button class="filter-btn" data-filter="series">Series</button>
                        <button class="filter-btn" data-filter="people">People</button>
                    </div>
                    
                    <div class="search-results" id="search-results">
                        <div class="search-placeholder">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            <p>Start typing to search for content</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Library Tab -->
            <div id="library-tab" class="tab-content">
                <div class="library-container">
                    <div class="library-header">
                        <h1>My Library</h1>
                        <div class="library-stats">
                            <span class="stat">
                                <span class="stat-number" id="watchlist-count">0</span>
                                <span class="stat-label">Watchlist</span>
                            </span>
                            <span class="stat">
                                <span class="stat-number" id="watching-count">0</span>
                                <span class="stat-label">Watching</span>
                            </span>
                            <span class="stat">
                                <span class="stat-number" id="completed-count">0</span>
                                <span class="stat-label">Completed</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="library-sections">
                        <section class="library-section">
                            <h2>Continue Watching</h2>
                            <div class="library-grid" id="continue-watching">
                                <!-- Content will be dynamically loaded -->
                            </div>
                        </section>
                        
                        <section class="library-section">
                            <h2>Watchlist</h2>
                            <div class="library-grid" id="watchlist">
                                <!-- Content will be dynamically loaded -->
                            </div>
                        </section>
                        
                        <section class="library-section">
                            <h2>Recently Added</h2>
                            <div class="library-grid" id="recently-added">
                                <!-- Content will be dynamically loaded -->
                            </div>
                        </section>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="settings-container">
                    <div class="settings-header">
                        <h1>Settings</h1>
                        <p class="settings-subtitle">Configure your streaming experience</p>
                    </div>
                    
                    <div class="settings-sections">
                        <!-- TMDB Integration section will be added dynamically by TMDBIntegration.js -->
                        
                        <section class="settings-section">
                            <h2>🎬 Catalog Management</h2>
                            <p class="section-description">Manage your content catalogs and sources</p>
                            
                            <div class="catalog-stats" id="catalog-stats">
                                <div class="stat-card">
                                    <span class="stat-number" id="total-catalogs">0</span>
                                    <span class="stat-label">Total Catalogs</span>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-number" id="enabled-catalogs">0</span>
                                    <span class="stat-label">Enabled</span>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-number" id="total-items">0</span>
                                    <span class="stat-label">Total Items</span>
                                </div>
                            </div>
                            
                            <div class="catalog-controls">
                                <button id="refresh-all-catalogs" class="btn btn-primary">
                                    <span class="btn-icon">🔄</span>
                                    Refresh All
                                </button>
                                <button id="export-catalogs" class="btn btn-secondary">
                                    <span class="btn-icon">📤</span>
                                    Export
                                </button>
                                <label for="import-catalogs" class="btn btn-secondary">
                                    <span class="btn-icon">📥</span>
                                    Import
                                    <input type="file" id="import-catalogs" accept=".json" style="display: none;">
                                </label>
                            </div>
                            
                            <div class="setting-item">
                                <div class="toggle-container">
                                    <input type="checkbox" id="auto-refresh-catalogs" class="toggle-input" checked>
                                    <label for="auto-refresh-catalogs" class="toggle-label">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-content">
                                        <span class="toggle-title">Auto-Refresh Catalogs</span>
                                        <span class="toggle-description">Automatically refresh catalog content</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <label for="refresh-interval" class="setting-label">Refresh Interval (minutes)</label>
                                <input type="number" id="refresh-interval" min="5" max="1440" value="30" class="setting-input">
                            </div>
                            
                            <div class="catalog-list" id="catalog-list">
                                <!-- Catalogs will be dynamically loaded -->
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>🔌 Add-ons</h2>
                            <p class="section-description">Manage Stremio add-ons for streaming sources</p>
                            
                            <div class="addon-input-group">
                                <input type="url" id="addon-url" placeholder="https://example.com/manifest.json" class="addon-input">
                                <button id="add-addon-btn" class="btn btn-primary">
                                    <span class="btn-icon">+</span>
                                    Add
                                </button>
                            </div>
                            
                            <div class="addon-help">
                                <p>💡 Add-ons provide access to different streaming sources</p>
                                <p>🔗 Enter the full manifest URL (usually ends with /manifest.json)</p>
                            </div>
                            
                            <div class="addon-list" id="addon-list">
                                <!-- Add-ons will be dynamically loaded -->
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>📱 External Players</h2>
                            <p class="section-description">Configure external video players</p>
                            
                            <div class="setting-item">
                                <div class="toggle-container">
                                    <input type="checkbox" id="enable-infuse" class="toggle-input" checked>
                                    <label for="enable-infuse" class="toggle-label">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-content">
                                        <span class="toggle-title">INFUSE</span>
                                        <span class="toggle-description">Enable INFUSE player support</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="toggle-container">
                                    <input type="checkbox" id="enable-vlc" class="toggle-input" checked>
                                    <label for="enable-vlc" class="toggle-label">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-content">
                                        <span class="toggle-title">VLC</span>
                                        <span class="toggle-description">Enable VLC player support</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="toggle-container">
                                    <input type="checkbox" id="enable-outplayer" class="toggle-input" checked>
                                    <label for="enable-outplayer" class="toggle-label">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-content">
                                        <span class="toggle-title">OUTPLAYER</span>
                                        <span class="toggle-description">Enable OUTPLAYER support</span>
                                    </div>
                                </div>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>🔧 Diagnostics</h2>
                            <p class="section-description">Troubleshooting and maintenance tools</p>
                            
                            <div class="diagnostic-controls">
                                <button onclick="app.addonDiagnostics.performHealthCheck()" class="btn btn-primary">
                                    <span class="btn-icon">🔍</span>
                                    Health Check
                                </button>
                                <button onclick="app.addonDiagnostics.installCommonAddons()" class="btn btn-secondary">
                                    <span class="btn-icon">📦</span>
                                    Install Popular
                                </button>
                                <button onclick="app.streamScraper.enableDebug()" class="btn btn-secondary">
                                    <span class="btn-icon">🐛</span>
                                    Debug Mode
                                </button>
                                <button onclick="console.log(app.streamScraper.getStats())" class="btn btn-secondary">
                                    <span class="btn-icon">📊</span>
                                    Show Stats
                                </button>
                            </div>
                        </section>
                        
                        <section class="settings-section">
                            <h2>🗑️ Cache & Storage</h2>
                            <p class="section-description">Manage application data and storage</p>
                            
                            <div class="cache-controls">
                                <button id="clear-cache-btn" class="btn btn-danger">
                                    <span class="btn-icon">🗑️</span>
                                    Clear Cache
                                </button>
                                <button id="reset-settings-btn" class="btn btn-danger">
                                    <span class="btn-icon">⚠️</span>
                                    Reset Settings
                                </button>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="stream-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="stream-modal-title">Select Stream</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stream-list" id="stream-list">
                    <!-- Stream options will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <div id="media-modal" class="modal">
        <div class="modal-content media-modal-content">
            <div class="modal-header">
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="media-details" id="media-details">
                    <!-- Media details will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Scripts -->
    <script src="StreamScraperV3.js"></script>
    <script src="AddonDiagnostics.js"></script>
    <script src="HomeTab.js"></script>
    <script src="SearchTab.js"></script>
    <script src="LibraryTab.js"></script>
    <script src="SettingsTab.js"></script>
    <script src="js/mdblist-browser.js"></script>
    <script src="MDBListIntegration.js"></script>
    <script src="TMDBIntegration.js"></script>
    <script src="CatalogManager.js"></script>
    <script src="CatalogGrid.js"></script>
    <script src="CatalogCarousel.js?v=2"></script>
    <script src="MediaDetailsModal.js"></script>
    <script src="HeroBanner.js"></script>
    <script src="StreamListModal.js"></script>
    <script src="ExternalPlayerHandler.js"></script>
    <script src="app.js"></script>
</body>
</html>